<!doctype html>
<html>
<head>
      <meta charset='utf-8' />
      <title>Mapping Memory Exercise</title>
      <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
      <script src='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.js'></script>
      <link href='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css' rel='stylesheet' />
      <style>
            body { margin:0; padding:0; }
            #map { position:absolute; top:0; bottom:0; width:100%; }
      </style>
</head>
      <body>
            <style>
                  #menu {
                        position: absolute; 
                        background: #fff;
                        padding: 10px;
                        font-family: 'Open Sans', sans-serif;
                  }
            </style>
            <div id='map'></div>
            <script>
                  var places, map, xhr;
                  function getIconFromCategory (categoryString) {
                        switch (categoryString) {
                              case 'slate quarry':
                                    return '/UK/industry-15.svg'
                              case 'mine':
                                    return '/UK/mountain-15.svg'
                              default:
                                    return 'bar'
                        }
                  }
                  function concatMainAndAlt (main, alt) {
                        
                  }
                  L.mapbox.accessToken = 'pk.eyJ1IjoibWljaGFlbG5ldCIsImEiOiItbWFqc3BvIn0.iuqIsFSNd5Ut-5_1W4RR_g';
                  map = L.mapbox.map('map').setView([51.487808, -3.184879], 5);
                  L.mapbox.styleLayer('mapbox://styles/michaelnet/ciutulpjz00152ipqoggp1xrl').addTo(map);
                  xhr = new XMLHttpRequest();
                  xhr.onreadystatechange = function() {
                        places = JSON.parse(this.responseText);
                        for (var i = 0; i < places.length; i++ ) {
                              var place = places[i];
                              console.log(place);
                              L.mapbox.featureLayer({
                                    type: 'Feature',
                                    geometry: {
                                          type: 'Point',
                                          coordinates: [place.longitude, place.latitude]
                                    },
                                    properties: {
                                          'title': place.name,
                                          'description': place.description,
                                          'marker-size': 'large',
                                          'marker-color': '#BE9A6B',
                                          'marker-symbol': getIconFromCategory(place.category)
                                    }
                              }).addTo(map);
                        }
                  };
                  xhr.open("GET", "https://mappingmemory.github.io/UK/places.json");
                  xhr.send();
</script>
</body>
</html>
